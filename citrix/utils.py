from common.rss_feed_parser import RSSFeedParser
from common.json_writer import JSONWriter
from citrix.row_parser import RowParser

def get_security_alerts_json(vendor, url):
    parser = RSSFeedParser(url)
    title = parser.get_title()
    rows = parser.get_cve_rows()

    row_parser = RowParser()
    writer = JSONWriter(rows, row_parser)
    json_alerts = writer.get_security_alerts_json(
        "vendor", vendor, url, None, title)
    return json_alerts

