from common.rss_feed_parser import RSSFeedParser
from common.json_writer import JSONWriter
from common.utils import dump_as_json
from citrix.row_parser import RowParser

def get_security_alerts_json(vendor, url, from_date_string, to_date_string):
    parser = RSSFeedParser(url)
    title = parser.get_title()
    rows = parser.get_cve_rows()

    row_parser = RowParser(from_date_string, to_date_string)
    writer = JSONWriter(rows, row_parser)
    cves = writer.parse_alerts(
        vendor, url, None, title)
    return dump_as_json(vendor,cves)

