from common.row_parser import BaseRowParser
from datetime import datetime

class RowParser(BaseRowParser): 
    
    def __init__(self):
        self.timestamp_format = '%Y-%m-%dT%H:%MZ'
        self.publishing__date_input_format = "%a, %d %b %Y %H:%M:%S %Z"

    def get_cells(self,row):
        return row

    def get_publish_date(self, row):
        return datetime.strptime(
                row.pubDate.text,
                self.publishing__date_input_format)

    def get_version_string(self, row):
        return "version"

    def get_product(self, cells, vendor, product):
        return "Citrix"

    def get_cve_id(self, row):
        heading = row.title.text
        if heading.startswith("CVE"):
            return heading.split()[0]
        return row.link.text.rsplit("/", 1)[1]

    def get_description(self, row):
        return row.description.text



