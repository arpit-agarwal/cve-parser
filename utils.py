from datetime import datetime


def split_on_any(string, delimiters):
    for delimiter in delimiters:
        if string.find(delimiter) != -1:
            versions = string.split(delimiter, 2)
            end = versions[1].strip()
            start = versions[0].strip()
            if delimiter == "and":
                return do_and_dilimiter_handling(start, end)

            return (start, end, None)
    return None


def do_and_dilimiter_handling(start, end):
    if start.strip() == "":
        return "Invalid"
    if end == "earlier":
        end = start
        start = None
    return (start, end, None)


def parse_version(version_string):
    return split_on_any(version_string, ["-", "to", "and"])


def get_publish_date(date_string, date_format):
    return datetime.strptime(date_string, "%B %d, %Y")


def format_date(date, date_format):
    return date.strftime('%Y-%m-%dT%H:%MZ')
