
from datetime import datetime
import json



class JSONWriter:

    def __init__(self, alerts, row_parser):
        self.alerts = alerts
        self.row_parser = row_parser

    def get_security_alerts_json(self, type_, vendor, url, product, webpage_name):
        securtiy_alerts = {
            "type": type_,
            "source": vendor,
            "cves": self.parse_alerts(vendor, url,product, webpage_name)
        }
        return json.dumps(securtiy_alerts)

    def parse_alerts(self, vendor, url,product, webpage_name):
        collection = list()
        alerts_list = self.alerts

        for alert in alerts_list:
            collection.append(self.row_parser.parse(
                alert, vendor, url,product, webpage_name))
        return collection

    