# Import libraries
import requests
from bs4 import BeautifulSoup


class Parser:

    def __init__(self, webpage):
        self.webpage = webpage

    def get_security_alerts(self, div_id):
        page = requests.get(self.webpage)
        soup = BeautifulSoup(page.text, 'html.parser')
        table = soup.find(id=div_id).find("table")
        alerts = table.find("tbody").find_all("tr")

        header_soup = table.find("thead")
        header = self.get_header(header_soup)
        title = self.get_title(soup.find("title"))
        return (title, header, alerts)

    def get_header(self, header_soup):
        header = list()
        cells = header_soup.find_all("strong")
        for cell in cells:
            header.append(cell.text)
        return header

    def get_title(self, title_soup):
        return title_soup.text
