from common.html_parser import HTMLParser
from common.json_writer import JSONWriter
from mongo_db.row_parser import RowParser

vendor = "mongodb"
product = "mongodb"
url = "https://www.mongodb.com/alerts"
security_div_id = "security-related"

parser = HTMLParser(url)

outer_div = parser.get_tag_by_id(security_div_id)
alerts = parser.get_table_rows(outer_div)
title = "MongoDB Alerts"
row_parser = RowParser()

writer = JSONWriter(alerts, row_parser)
json_alerts = writer.get_security_alerts_json(
    "vendor", vendor, url, product, title)
print(json_alerts)
