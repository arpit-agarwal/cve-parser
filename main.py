from common.parser import Parser
from common.json_writer import JSONWriter
from mongodb.row_parser import RowParser

vendor = "mongodb"
product = "mongodb"
url = "https://www.mongodb.com/alerts"
security_div_id = "security-related"
parser = Parser(url)
outer_div = parser.get_tag_by_id(security_div_id)
alerts = parser.get_security_alerts(outer_div)

row_parser = RowParser()
writer = JSONWriter(alerts, row_parser)
json_alerts = writer.get_security_alerts_json(
    "vendor", vendor, url, product, "MongoDB Alerts")
print(json_alerts)
