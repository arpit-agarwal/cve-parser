from common.parser import Parser
from common.json_writer import JSONWriter
from adobe_experience_manager.row_parser import RowParser

vendor = "adobe"
product = "experience_manager"
title = "APSB20-01 Security update available for Adobe Experience Manager"
url = "https://helpx.adobe.com/security/products/experience-manager/apsb20-01.html"
security_div_id = "Vulnerabilitydetails"
parser = Parser(url)
h2 = parser.get_tag_by_id(security_div_id)
h2_div = h2.parent.parent
outer_div = h2_div.next_sibling.next_sibling

alerts = parser.get_security_alerts(outer_div)

# remove header row
del alerts[0]

row_parser = RowParser()
writer = JSONWriter(alerts, row_parser)
json_alerts = writer.get_security_alerts_json(
    "vendor", vendor, url, product, title)
print(json_alerts)

